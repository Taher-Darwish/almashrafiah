# نظام إدارة المشاريع - شركة المشرفية
## دليل الاستخدام الشامل

---

## 📋 نظرة عامة

تم تطوير نظام كامل لإدارة المشاريع العقارية باستخدام Firebase، يتضمن:

### ✅ الملفات المضافة

1. **`firebase-config.js`** - إعدادات Firebase والخدمات
2. **`admin.html`** - صفحة تسجيل الدخول
3. **`admin-login.js`** - منطق تسجيل الدخول
4. **`dashboard.html`** - لوحة التحكم الرئيسية
5. **`dashboard.js`** - منطق إدارة المشاريع (إضافة/تعديل/حذف)
6. **`project.html`** - صفحة تفاصيل المشروع
7. **`project.js`** - منطق عرض تفاصيل المشروع
8. **`projects-loader.js`** - تحميل المشاريع في الصفحة الرئيسية

### 🔄 الملفات المُحدّثة

1. **`index.html`** - إضافة قسم "مشاريعنا" + تحديث القائمة العلوية
2. **`script.js`** - إضافة ترجمات i18n + منطق تحميل المشاريع
3. **`styles.css`** - إضافة تصاميم قسم المشاريع والكروت

---

## 🚀 خطوات البدء

### 1️⃣ إعداد Firebase

قبل البدء، تأكد من إعداد Firebase بشكل صحيح:

#### أ) إعداد Authentication (المصادقة)

1. افتح [Firebase Console](https://console.firebase.google.com/)
2. اختر مشروع **almashrafiah**
3. اذهب إلى **Authentication** من القائمة الجانبية
4. اضغط على **Get Started**
5. من تبويب **Sign-in method**، فعّل **Email/Password**
6. اضغط **Save**

#### ب) إضافة مستخدم Admin

1. في نفس صفحة **Authentication**
2. اذهب إلى تبويب **Users**
3. اضغط **Add User**
4. أدخل:
   - **Email**: `admin@almashrafiah.sa` (أو أي بريد تريده)
   - **Password**: كلمة مرور قوية (احفظها!)
5. اضغط **Add User**

#### ج) إعداد Firestore Database (قاعدة البيانات)

1. اذهب إلى **Firestore Database** من القائمة
2. اضغط **Create Database**
3. اختر **Start in production mode** (أو test mode مؤقتاً)
4. اختر المنطقة الجغرافية: **eur3 (europe-west)** أو الأقرب لك
5. اضغط **Enable**

#### د) ضبط قواعد Firestore (مهم للأمان!)

1. في صفحة Firestore، اذهب إلى تبويب **Rules**
2. استبدل القواعد بالتالي:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // السماح للجميع بقراءة المشاريع (للعرض في الموقع)
    match /projects/{projectId} {
      allow read: if true;
      // السماح بالكتابة/التعديل/الحذف للمستخدمين المسجلين فقط
      allow write, update, delete: if request.auth != null;
    }
  }
}
```

3. اضغط **Publish**

#### هـ) إعداد Storage (تخزين الصور)

1. اذهب إلى **Storage** من القائمة
2. اضغط **Get Started**
3. اختر **Start in production mode**
4. اضغط **Next** ثم **Done**

#### و) ضبط قواعد Storage

1. في صفحة Storage، اذهب إلى تبويب **Rules**
2. استبدل القواعد بالتالي:

```javascript
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /projects/{allPaths=**} {
      // السماح للجميع بقراءة الصور
      allow read: if true;
      // السماح برفع/تعديل/حذف الصور للمستخدمين المسجلين فقط
      allow write, delete: if request.auth != null;
    }
  }
}
```

3. اضغط **Publish**

---

## 🔐 تسجيل الدخول إلى لوحة التحكم

1. افتح الرابط: `https://yourwebsite.com/admin.html`
2. أدخل البريد وكلمة المرور اللذين أنشأتهما في Firebase
3. اضغط **تسجيل الدخول**

✅ إذا نجح التسجيل، سيتم توجيهك تلقائياً إلى لوحة التحكم

---

## ➕ إضافة مشروع جديد

### الخطوات:

1. في لوحة التحكم، اضغط على **"إضافة مشروع جديد"** (الزر الأخضر)
2. املأ جميع الحقول المطلوبة:

#### أ) المعلومات الأساسية (مطلوبة)

- **عنوان المشروع (عربي)**: مثال: "مجمع الياسمين السكني"
- **عنوان المشروع (إنجليزي)**: مثال: "Al-Yasmin Residential Complex"
- **الموقع (عربي)**: مثال: "الرياض - حي الياسمين"
- **الموقع (إنجليزي)**: مثال: "Riyadh - Al-Yasmin District"
- **وصف المشروع (عربي)**: وصف تفصيلي للمشروع بالعربية
- **وصف المشروع (إنجليزي)**: نفس الوصف بالإنجليزية

#### ب) المواصفات (اختيارية)

- **المساحة**: مثال: "500"
- **السعر**: مثال: "1,500,000"
- **عدد الوحدات**: مثال: "20"
- **تاريخ التسليم**: مثال: "Q4 2025" أو "الربع الرابع 2025"

#### ج) الحالة (مطلوبة)

اختر إحدى الخيارات:
- **متاح** (available) - المشروع متاح للشراء
- **مباع** (sold) - المشروع تم بيعه
- **قريباً** (upcoming) - المشروع قريباً

#### د) الصور (مطلوبة)

1. **الصورة الرئيسية** (مطلوبة):
   - اضغط على منطقة "الصورة الرئيسية"
   - اختر صورة واحدة بجودة عالية
   - هذه الصورة ستظهر في بطاقة المشروع والبانر

2. **صور المعرض** (اختيارية):
   - اضغط على منطقة "صور المعرض"
   - يمكنك اختيار عدة صور مرة واحدة (Ctrl/Cmd + Click)
   - هذه الصور ستظهر في صفحة تفاصيل المشروع

3. اضغط **"حفظ المشروع"**

✅ سيظهر المشروع مباشرة في:
- لوحة التحكم
- الصفحة الرئيسية (قسم "مشاريعنا")
- صفحة تفاصيل المشروع الخاصة به

---

## ✏️ تعديل مشروع موجود

1. في لوحة التحكم، ابحث عن المشروع
2. اضغط على زر **"تعديل"** (الأزرق)
3. ستفتح نافذة التعديل مع البيانات الحالية
4. عدّل ما تريد:
   - يمكنك تغيير النصوص دون المساس بالصور
   - لتغيير الصورة الرئيسية: ارفع صورة جديدة
   - لتغيير صور المعرض: ارفع صور جديدة (ستستبدل القديمة)
   - إذا لم ترفع صور جديدة، ستبقى الصور القديمة كما هي
5. اضغط **"حفظ المشروع"**

---

## 🗑️ حذف مشروع

1. في لوحة التحكم، ابحث عن المشروع
2. اضغط على زر **"حذف"** (الأحمر)
3. ستظهر رسالة تأكيد
4. اضغط **"OK"** للتأكيد

⚠️ **تحذير**: الحذف نهائي ولا يمكن التراجع عنه!

---

## 🌐 كيف يظهر المشروع في الموقع؟

### 1️⃣ الصفحة الرئيسية

في قسم **"مشاريعنا"**، سيظهر كل مشروع في بطاقة تحتوي على:
- الصورة الرئيسية
- العنوان (عربي/إنجليزي حسب اللغة المختارة)
- الموقع
- جزء من الوصف (أول 120 حرف)
- حالة المشروع (متاح/مباع/قريباً)
- زر "عرض التفاصيل"

### 2️⃣ صفحة تفاصيل المشروع

عند الضغط على **"عرض التفاصيل"**:
- بانر كبير بالصورة الرئيسية + العنوان والموقع
- الوصف الكامل للمشروع
- جدول المواصفات (المساحة، السعر، الوحدات، التسليم، الموقع)
- معرض الصور (إذا تم رفع صور إضافية)
- زر "تواصل معنا" للاستفسار عن المشروع

---

## 🔄 تبديل اللغة

- النظام يدعم العربية والإنجليزية بالكامل
- عند تغيير اللغة من الموقع:
  - تتغير كل النصوص
  - تُحمّل عناوين ومواقع وأوصاف المشاريع باللغة المختارة
  - يتم حفظ اللغة المفضلة في المتصفح

---

## 📱 الاستجابة والأداء

- **تصميم متجاوب بالكامل**: يعمل على الجوال، التابلت، والكمبيوتر
- **تحميل سريع**: المشاريع تُحمّل تلقائياً بعد نصف ثانية من فتح الصفحة
- **صور محسّنة**: Firebase Storage يقدم الصور من CDN عالمي بسرعة عالية

---

## 🛡️ الأمان

### ما تم تطبيقه:

✅ **لوحة التحكم محمية** - لا يمكن الوصول إليها إلا بتسجيل الدخول  
✅ **Firebase Authentication** - نظام مصادقة قوي من Google  
✅ **Firestore Rules** - فقط المستخدمون المسجلون يمكنهم الإضافة/التعديل/الحذف  
✅ **Storage Rules** - فقط المستخدمون المسجلون يمكنهم رفع الصور  
✅ **القراءة عامة** - أي زائر يمكنه مشاهدة المشاريع (كما هو مطلوب)  

---

## ⚙️ الإعدادات المتقدمة

### تغيير بيانات تسجيل الدخول

لتغيير بريد Admin أو إضافة مستخدمين آخرين:

1. افتح Firebase Console
2. اذهب إلى **Authentication > Users**
3. يمكنك:
   - إضافة مستخدمين جدد
   - تعديل البريد
   - إعادة تعيين كلمة المرور
   - حذف مستخدمين

### تحسين الأداء

إذا كان لديك الكثير من المشاريع (أكثر من 50):

1. افتح `script.js`
2. ابحث عن السطر:
   ```javascript
   const q = query(collection(db, 'projects'), orderBy('createdAt', 'desc'));
   ```
3. أضف `limit`:
   ```javascript
   import { limit } from './firebase-config.js';
   const q = query(collection(db, 'projects'), orderBy('createdAt', 'desc'), limit(20));
   ```

---

## 🐛 حل المشاكل الشائعة

### المشكلة: "لا تظهر المشاريع في الموقع"

**الحل:**
1. تأكد من أنك أضفت مشاريع من لوحة التحكم
2. افتح Console في المتصفح (F12) وتحقق من الأخطاء
3. تأكد من أن قواعد Firestore صحيحة (السماح بالقراءة)

### المشكلة: "لا يمكنني تسجيل الدخول"

**الحل:**
1. تأكد من تفعيل Email/Password في Firebase Authentication
2. تأكد من إضافة المستخدم بشكل صحيح
3. تحقق من البريد وكلمة المرور

### المشكلة: "لا يمكنني رفع الصور"

**الحل:**
1. تأكد من تفعيل Firebase Storage
2. تأكد من أن قواعد Storage صحيحة
3. تحقق من حجم الصورة (يُفضل أقل من 5MB)

### المشكلة: "الصور بطيئة في التحميل"

**الحل:**
1. ضغط الصور قبل رفعها (استخدم أدوات مثل TinyPNG)
2. حجم الصورة الرئيسية يُفضل: 1200x800px
3. حجم صور المعرض يُفضل: 1000x750px

---

## 📞 الدعم الفني

إذا واجهت أي مشكلة:

1. **تحقق من Console في المتصفح** (F12) - غالباً ستجد رسالة الخطأ هناك
2. **راجع Firebase Console** - تحقق من الـ Usage & Billing لمعرفة إذا وصلت للحد المجاني
3. **تحقق من قواعد Firestore و Storage** - معظم المشاكل سببها القواعد الخاطئة

---

## 🎉 تم بنجاح!

الآن لديك نظام كامل لإدارة المشاريع:

✅ لوحة تحكم احترافية  
✅ إضافة/تعديل/حذف المشاريع  
✅ رفع صور متعددة  
✅ عرض تلقائي في الموقع  
✅ صفحات تفاصيل منفصلة لكل مشروع  
✅ دعم كامل للغتين  
✅ تصميم متجاوب  
✅ أمان عالي  
✅ سرعة وأداء ممتاز  

**بالتوفيق! 🚀**
